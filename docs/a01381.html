<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>&#x202A;libpcl: &#x202A;Hash Table</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">&#x202A;libpcl
   </div>
   <div id="projectbrief">&#x202A;Portable C Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Hash Table</div>  </div>
</div><!--header-->
<div class="contents">

<p>&#x202A;This defines a hash table object and associated management functions.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01417.html">pcl_htable_entry_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">&#x202A;Hash table entry object.  <a href="a01417.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01421.html">tag_pcl_htable</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga9c4338babd32ed1c05f5ad65b61662d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> <a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01381.html#ga9c4338babd32ed1c05f5ad65b61662d2">pcl_htable</a> (int capacity)</td></tr>
<tr class="memdesc:ga9c4338babd32ed1c05f5ad65b61662d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">&#x202A;Creates a new hash table object.  <a href="a01381.html#ga9c4338babd32ed1c05f5ad65b61662d2">More...</a><br /></td></tr>
<tr class="separator:ga9c4338babd32ed1c05f5ad65b61662d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf673faae1ea3f2d1d49538121f4b150e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> <a class="el" href="a01417.html">pcl_htable_entry_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01381.html#gaf673faae1ea3f2d1d49538121f4b150e">pcl_htable_lookup</a> (const <a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a> *ht, const void *key)</td></tr>
<tr class="memdesc:gaf673faae1ea3f2d1d49538121f4b150e"><td class="mdescLeft">&#160;</td><td class="mdescRight">&#x202A;Lookup and return an entry.  <a href="a01381.html#gaf673faae1ea3f2d1d49538121f4b150e">More...</a><br /></td></tr>
<tr class="separator:gaf673faae1ea3f2d1d49538121f4b150e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga00324aa197254805fd247819cf95164d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01381.html#ga00324aa197254805fd247819cf95164d">pcl_htable_get</a> (const <a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a> *ht, const void *key)</td></tr>
<tr class="memdesc:ga00324aa197254805fd247819cf95164d"><td class="mdescLeft">&#160;</td><td class="mdescRight">&#x202A;Lookup an entry and return its value.  <a href="a01381.html#ga00324aa197254805fd247819cf95164d">More...</a><br /></td></tr>
<tr class="separator:ga00324aa197254805fd247819cf95164d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaababde7190354fb3a74138272c1e90cd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01381.html#gaababde7190354fb3a74138272c1e90cd">pcl_htable_put</a> (<a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a> *ht, const void *key, void *value, bool unique)</td></tr>
<tr class="memdesc:gaababde7190354fb3a74138272c1e90cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">&#x202A;Puts a key/value pair into the table.  <a href="a01381.html#gaababde7190354fb3a74138272c1e90cd">More...</a><br /></td></tr>
<tr class="separator:gaababde7190354fb3a74138272c1e90cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf0360dbdb51aea5ba45f0b398d1319a8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01381.html#gaf0360dbdb51aea5ba45f0b398d1319a8">pcl_htable_remove</a> (<a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a> *ht, const void *key)</td></tr>
<tr class="memdesc:gaf0360dbdb51aea5ba45f0b398d1319a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">&#x202A;Remove an entry from the table.  <a href="a01381.html#gaf0360dbdb51aea5ba45f0b398d1319a8">More...</a><br /></td></tr>
<tr class="separator:gaf0360dbdb51aea5ba45f0b398d1319a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4162cecb47c4e51ed421bb043a2c4827"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> <a class="el" href="a00113.html#a157296b59a693af5c94886de7d036223">pcl_array_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01381.html#ga4162cecb47c4e51ed421bb043a2c4827">pcl_htable_keys</a> (const <a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a> *ht)</td></tr>
<tr class="memdesc:ga4162cecb47c4e51ed421bb043a2c4827"><td class="mdescLeft">&#160;</td><td class="mdescRight">&#x202A;Get hash table keys as an array.  <a href="a01381.html#ga4162cecb47c4e51ed421bb043a2c4827">More...</a><br /></td></tr>
<tr class="separator:ga4162cecb47c4e51ed421bb043a2c4827"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0c0e446d70b2fa00e5c2823ed3b7de27"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> <a class="el" href="a01417.html">pcl_htable_entry_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01381.html#ga0c0e446d70b2fa00e5c2823ed3b7de27">pcl_htable_iter</a> (<a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a> *ht, int *index)</td></tr>
<tr class="memdesc:ga0c0e446d70b2fa00e5c2823ed3b7de27"><td class="mdescLeft">&#160;</td><td class="mdescRight">&#x202A;Iterate through a table's entries.  <a href="a01381.html#ga0c0e446d70b2fa00e5c2823ed3b7de27">More...</a><br /></td></tr>
<tr class="separator:ga0c0e446d70b2fa00e5c2823ed3b7de27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8b1170fdf3619ddac333d144c4b10a93"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01381.html#ga8b1170fdf3619ddac333d144c4b10a93">pcl_htable_clear</a> (<a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a> *ht, bool shrink)</td></tr>
<tr class="memdesc:ga8b1170fdf3619ddac333d144c4b10a93"><td class="mdescLeft">&#160;</td><td class="mdescRight">&#x202A;Clear all entries from the table.  <a href="a01381.html#ga8b1170fdf3619ddac333d144c4b10a93">More...</a><br /></td></tr>
<tr class="separator:ga8b1170fdf3619ddac333d144c4b10a93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga59f432a730f55758cc65114510213f95"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01381.html#ga59f432a730f55758cc65114510213f95">pcl_htable_free</a> (<a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a> *ht)</td></tr>
<tr class="memdesc:ga59f432a730f55758cc65114510213f95"><td class="mdescLeft">&#160;</td><td class="mdescRight">&#x202A;Release all resources used by the given hash table.  <a href="a01381.html#ga59f432a730f55758cc65114510213f95">More...</a><br /></td></tr>
<tr class="separator:ga59f432a730f55758cc65114510213f95"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p class="DocNodeLTR">This defines a hash table object and associated management functions. </p>
<p class="DocNodeLTR">This implementation will preserve insertion order: like Java's LinkedHashMap but without the doubly-linked list.</p>
<h3 class="DocNodeLTR"><a class="anchor" id="autotoc_md27"></a>
Implementation</h3>
<p class="DocNodeLTR">Whenever an entry is put, it is added sequentially to an array of entry objects. To handle collisions, the entry objects are a linked list using an integer value that represents the index of the next collision within the entry array. The key is hashed using Google's FarmHash and bitwise AND'd with the current table size minus 1 to get the hashed index value. The hashed index value is an index to a second array (entry_lookup) of entry array indexes. Thus, looking up a hashed index within the <em>entry_lookup</em> array, will give you the entry array index, which is the beginning of the entry collision list. This is how the PCL hash table can preserve insertion order: one array using hash index to find the index into the sequential array of entries.</p>
<dl class="section note DocNodeLTR"><dt>Note</dt><dd>&#x202A;The entry_lookup and entry array idea came directly from PHP's new hash table implementation released in 7.0. Just like PHP, PCL allocates the entry and entry_lookup arrays as one allocation: both with <em>capacity</em> elements. When an entry is removed, the entry array marks it as deleted but does not adjust the array to close the gap. An entry is marked as deleted by setting its <em>key</em> to <code>NULL</code>, which PCL treats as an invalid key. On rehash, the entry array is defragmented.</dd></dl>
<h3 class="DocNodeLTR"><a class="anchor" id="autotoc_md28"></a>
Default Hash Function</h3>
<p class="DocNodeLTR">Unlike PHP's implementation, PCL does not use the DJBX33A hash as its default, which stands for “Daniel J. Bernstein, Times 33 with Addition”. Google's farmhash proved to have far less collisions (on string data since DJBX33A is for string keys). In one test of 470,000 english words, Google's FarmHash had no collisions while DJBX33A had 320. Performance wise, they are about the same. Another benifit of Google's FarmHash is that it is not just designed for string keys, which PCL requires to allow binary and string keys. It is also prefered to provide a single generalized hash function for both binary and string keys out of the box.</p>
<h3 class="DocNodeLTR"><a class="anchor" id="autotoc_md29"></a>
Customizing</h3>
<p class="DocNodeLTR">This implementation has the ability to set a minimum and maximum load factor. You can also set the <em>key_len</em> if not using string keys. If key_len is 0 (strings), then the default key_equals function uses strcmp. If key_len is not 0, memcmp is used. There are three callbacks to customize a hash table: <a class="el" href="a01421.html#aa29bc4287f3bba04ee0471d6e8979c5a" title="&#x202A;Called when an entry is being removed from the table.">pcl_htable_t.remove_entry</a>, <a class="el" href="a01421.html#a33adfa1338869be7f83985d3bf1e0a38" title="&#x202A;Compute a hash code for the given key.">pcl_htable_t.hashcode</a> and <a class="el" href="a01421.html#a1d24fd47b1023fb237ae37964028806a" title="&#x202A;Determine if two keys are equal.">pcl_htable_t.key_equals</a>. All of these customizations can be set after table creation.</p>
<h3 class="DocNodeLTR"><a class="anchor" id="autotoc_md30"></a>
Rehashing</h3>
<p class="DocNodeLTR">Rehashing is implemented by allocating a new entry and entry_lookup array (single allocation) that is either double the current size or half the current size (uses powers of 2). When the copy is complete, the old entry and entry_lookup arrays are freed. No hash codes are recomputed, since each entry caches its own hash code. The entry array is defragmented, meaning all deleted entries are removed; <em>count_used</em> will always be the same as <em>count</em>.</p>
<h3 class="DocNodeLTR"><a class="anchor" id="autotoc_md31"></a>
Table Size Limitations</h3>
<p class="DocNodeLTR">The table can grow to 33,554,432 on 32-bit machines and 1,073,741,824 on 64-bit machines. This table expands and contracts based on a max and min load factor &ndash; 0.75 and 0.20 respectively. Table capacity is always powers of two.</p>
<h3 class="DocNodeLTR"><a class="anchor" id="autotoc_md32"></a>
String and Binary Keys</h3>
<p class="DocNodeLTR">The PCL hash table supports binary keys, which are fixed-length and normally do not change for the life of the hash table. After creating a hash table, one can specify the key length in bytes or provide zero (the default) for variable-length keys (strings). For example, when using a UUID string as a key, each key would require 36 bytes. However, only 16 bytes per key if binary. In this case, you would set the key_len to 16. The default <code>key_equals</code> will use <code>memcmp</code> when <em>key_len</em> is not zero and <code>strcmp</code> otherwise.</p>
<h4 class="DocNodeLTR"><a class="anchor" id="autotoc_md33"></a>
UUID Key Example</h4>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00059.html">pcl/htable.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00062.html">pcl/init.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00098.html">pcl/string.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;app/user.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *uuidtokey(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *out, <span class="keyword">const</span> <span class="keywordtype">char</span> *uuid)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> *hex = <a class="code" href="a01390.html#ga3b40ca44ca057a1a30a653533ab89481">pcl_strreplace</a>(uuid, <span class="stringliteral">&quot;-&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">  <a class="code" href="a01390.html#ga27a03710e9bf0a479cc6f0d83855bf68">pcl_hex_decode</a>(out, 16, hex);</div>
<div class="line">  <a class="code" href="a01370.html#gab88b901c82e1010555b08ff6d39490f2">pcl_free</a>(hex);</div>
<div class="line">  <span class="keywordflow">return</span> out;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> remove_entry(<span class="keyword">const</span> <span class="keywordtype">void</span> *key, <span class="keywordtype">void</span> *value)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="a01370.html#gab88b901c82e1010555b08ff6d39490f2">pcl_free</a>(key);</div>
<div class="line">  app_user_free((app_user_t *) value);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="a01382.html#gac1f7c09d58b0d949a660b42924dd21d4">pcl_init</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> num;</div>
<div class="line">  app_user_t **users = app_user_fetchall(&amp;num);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="a01421.html">pcl_htable_t</a> *ht = <a class="code" href="a01381.html#ga9c4338babd32ed1c05f5ad65b61662d2">pcl_htable</a>(num);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// let htable know key length, only used by default key_equals and hashcode callbacks</span></div>
<div class="line">  ht-&gt;<a class="code" href="a01421.html#aaa2dc552577da2bba064c4d36d971c26">key_len</a> = 16;</div>
<div class="line">  ht-&gt;<a class="code" href="a01421.html#aa29bc4287f3bba04ee0471d6e8979c5a">remove_entry</a> = remove_entry;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> uuid[16];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; num; i++)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordtype">void</span> *key = <a class="code" href="a01370.html#ga1df8575b9ae906470c782db9c26201e8">pcl_malloc</a>(16);</div>
<div class="line">    memcpy(key, uuidtokey(uuid, users[i]-&gt;uuid), 16);</div>
<div class="line">    <a class="code" href="a01381.html#gaababde7190354fb3a74138272c1e90cd">pcl_htable_put</a>(ht, key, users[i], <span class="keyword">true</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// elements will be freed by hash table&#39;s remove_entry</span></div>
<div class="line">  <a class="code" href="a01370.html#gab88b901c82e1010555b08ff6d39490f2">pcl_free</a>(users);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *john = <span class="stringliteral">&quot;37462d98-371b-11eb-adc1-0242ac120002&quot;</span>;</div>
<div class="line">  pcl_user_t *user = <a class="code" href="a01381.html#ga00324aa197254805fd247819cf95164d">pcl_htable_get</a>(ht, uuidtokey(uuid, john));</div>
<div class="line"> </div>
<div class="line">  printf(<span class="stringliteral">&quot;%s\n&quot;</span>, user-&gt;surname);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="a01381.html#ga59f432a730f55758cc65114510213f95">pcl_htable_free</a>(ht);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p class="DocNodeLTR">One step further, is taking a 32 or 64-bit sequence value, like a <code>user_id</code>, and storing its value as the key pointer address: <code>key = (const void *)(uintptr_t) user_id</code>. This would require a custom key_equals (where key1 == key2 could be the implementation) and a custom hashcode callback (where return (uintptr_t) key; could be the implementation). This method is very efficient both in memory and performance, but only works if the numeric bit length is <code>&lt;=</code> the number of bits used by pointers. Also, user_id of 0 is invalid, since keys cannot be <code>NULL</code>, but it is uncommon to start sequence values like user_ids with 0. An example of this is below.</p>
<h4 class="DocNodeLTR"><a class="anchor" id="autotoc_md34"></a>
UserId Key Example</h4>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00059.html">pcl/htable.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00062.html">pcl/init.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;app/user.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define IDTOKEY(id) (const void *) ((uintptr_t) (id))</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">bool</span> key_equals(<span class="keyword">const</span> <span class="keywordtype">void</span> *a, <span class="keyword">const</span> <span class="keywordtype">void</span> *b, <span class="keywordtype">size_t</span> key_len)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="a00038.html#a9b58a1294d89c976dfbe4dc480e9dfb8">UNUSED</a>(key_len);</div>
<div class="line">  <span class="keywordflow">return</span> a == b; <span class="comment">// key addresses are user_ids, compare them directly.</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uintptr_t hashcode(<span class="keyword">const</span> <span class="keywordtype">void</span> *key, <span class="keywordtype">size_t</span> key_len)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="a00038.html#a9b58a1294d89c976dfbe4dc480e9dfb8">UNUSED</a>(key_len);</div>
<div class="line">  <span class="keywordflow">return</span> (uintptr_t) key; <span class="comment">// no need to hash keys, user_id is unique</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> remove_entry(<span class="keyword">const</span> <span class="keywordtype">void</span> *key, <span class="keywordtype">void</span> *value)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="a00038.html#a9b58a1294d89c976dfbe4dc480e9dfb8">UNUSED</a>(key);</div>
<div class="line">  app_user_free((app_user_t *) value); <span class="comment">// key doesn&#39;t need to be freed</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="a01382.html#gac1f7c09d58b0d949a660b42924dd21d4">pcl_init</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> num_users;</div>
<div class="line">  app_user_t **users = app_user_fetchall(&amp;num_users);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// a table mapping a user_id =&gt; user.</span></div>
<div class="line">  <a class="code" href="a01421.html">pcl_htable_t</a> *ht = <a class="code" href="a01381.html#ga9c4338babd32ed1c05f5ad65b61662d2">pcl_htable</a>(num_users);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// configuring a pcl_htable_t</span></div>
<div class="line">  ht-&gt;<a class="code" href="a01421.html#aa29bc4287f3bba04ee0471d6e8979c5a">remove_entry</a> = remove_entry;</div>
<div class="line">  ht-&gt;<a class="code" href="a01421.html#a33adfa1338869be7f83985d3bf1e0a38">hashcode</a> = hashcode;</div>
<div class="line">  ht-&gt;<a class="code" href="a01421.html#a1d24fd47b1023fb237ae37964028806a">key_equals</a> = key_equals;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// ignored since example sets hashcode and key_equals. Set if your callbacks need it.</span></div>
<div class="line">  <span class="comment">//ht-&gt;key_len = sizeof(int64_t);</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// set min and max load factor</span></div>
<div class="line">  <span class="comment">//ht-&gt;min_loadfac = 0.13f;</span></div>
<div class="line">  <span class="comment">//ht-&gt;max_loadfac = 0.85f;</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// set key address to user_id</span></div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; num_users; i++)</div>
<div class="line">    <a class="code" href="a01381.html#gaababde7190354fb3a74138272c1e90cd">pcl_htable_put</a>(ht, IDTOKEY(users[i]-&gt;<span class="keywordtype">id</span>), users[i], <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="a01370.html#gab88b901c82e1010555b08ff6d39490f2">pcl_free</a>(users); <span class="comment">// elements freed by remove_entry</span></div>
<div class="line"> </div>
<div class="line">  app_user_t *user = <a class="code" href="a01381.html#ga00324aa197254805fd247819cf95164d">pcl_htable_get</a>(ht, IDTOKEY(1982734));</div>
<div class="line"> </div>
<div class="line">  printf(<span class="stringliteral">&quot;%s\n&quot;</span>, user-&gt;name);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="a01381.html#ga59f432a730f55758cc65114510213f95">pcl_htable_free</a>(ht); <span class="comment">// calls remove_entry foreach entry in table</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> <h2 class="groupheader">Function Documentation</h2>
<a id="ga9c4338babd32ed1c05f5ad65b61662d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9c4338babd32ed1c05f5ad65b61662d2">&#9670;&nbsp;</a></span>pcl_htable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> <a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a>* pcl_htable </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>capacity</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="a00059.html">pcl/htable.h</a>&gt;</code></p>

<p>&#x202A;Creates a new hash table object. </p>
<p class="DocNodeLTR">All hash table callbacks are set to the default implementations as documented. After creating a hash table, you can assign callbacks. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">capacity</td><td>&#x202A;initial capacity of hash table. If this is not a power of 2, it is rounded up to the next power of 2. A value less than 8, will set capacity to 8 (smallest table size). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>&#x202A;hash table pointer or NULL on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00524_source.html#l00059">59</a> of file <a class="el" href="a00524_source.html">htable.c</a>.</p>

<p class="reference">References <a class="el" href="a00059_source.html#l00269">tag_pcl_htable::capacity</a>, <a class="el" href="a00059_source.html#l00258">tag_pcl_htable::count</a>, <a class="el" href="a00059_source.html#l00264">tag_pcl_htable::count_used</a>, <a class="el" href="a00527_source.html#l00036">ipcl_htable_chkcapacity()</a>, <a class="el" href="a00059_source.html#l00342">tag_pcl_htable::key_equals</a>, <a class="el" href="a00059_source.html#l00306">tag_pcl_htable::key_len</a>, <a class="el" href="a00059_source.html#l00324">tag_pcl_htable::max_loadfac</a>, <a class="el" href="a00521_source.html#l00037">MAX_LOADFAC</a>, <a class="el" href="a00059_source.html#l00315">tag_pcl_htable::min_loadfac</a>, <a class="el" href="a00521_source.html#l00038">MIN_LOADFAC</a>, <a class="el" href="a01370.html#ga1df8575b9ae906470c782db9c26201e8">pcl_malloc()</a>, <a class="el" href="a00017_source.html#l00287">R_TRC</a>, and <a class="el" href="a00059_source.html#l00274">tag_pcl_htable::table_mask</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00722_source.html#l00044">pcl_json_obj()</a>.</p>

</div>
</div>
<a id="gaf673faae1ea3f2d1d49538121f4b150e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf673faae1ea3f2d1d49538121f4b150e">&#9670;&nbsp;</a></span>pcl_htable_lookup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> <a class="el" href="a01417.html">pcl_htable_entry_t</a>* pcl_htable_lookup </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a> *&#160;</td>
          <td class="paramname"><em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="a00059.html">pcl/htable.h</a>&gt;</code></p>

<p>&#x202A;Lookup and return an entry. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ht</td><td>&#x202A;pointer to hash table object </td></tr>
    <tr><td class="paramname">key</td><td>&#x202A;pointer to the key to lookup </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>&#x202A;pointer to the key's entry or NULL if not found or an error occurs. If not found, the last PCL error (pcl_errno) is set to PCL_ENOTFOUND. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00548_source.html#l00036">36</a> of file <a class="el" href="a00548_source.html">htable_lookup.c</a>.</p>

<p class="reference">References <a class="el" href="a00548_source.html#l00047">ipcl_htable_lookup()</a>, <a class="el" href="a00020_source.html#l00078">PCL_EINVAL</a>, <a class="el" href="a00017_source.html#l00145">R_SETERR</a>, and <a class="el" href="a00017_source.html#l00287">R_TRC</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00536_source.html#l00036">pcl_htable_get()</a>.</p>

</div>
</div>
<a id="ga00324aa197254805fd247819cf95164d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga00324aa197254805fd247819cf95164d">&#9670;&nbsp;</a></span>pcl_htable_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> void* pcl_htable_get </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a> *&#160;</td>
          <td class="paramname"><em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="a00059.html">pcl/htable.h</a>&gt;</code></p>

<p>&#x202A;Lookup an entry and return its value. </p>
<p class="DocNodeLTR">This is a convenience function that wraps <a class="el" href="a01381.html#gaf673faae1ea3f2d1d49538121f4b150e" title="&#x202A;Lookup and return an entry.">pcl_htable_lookup</a>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ht</td><td>&#x202A;pointer to hash table object </td></tr>
    <tr><td class="paramname">key</td><td>&#x202A;pointer to a key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>&#x202A;value pointer or NULL if not found. values can be NULL. To detect an error verse a NULL value, check pcl_errno: if(value == NULL &amp;&amp; pcl_errno == PCL_EOKAY) success; Or, use <a class="el" href="a01381.html#gaf673faae1ea3f2d1d49538121f4b150e" title="&#x202A;Lookup and return an entry.">pcl_htable_lookup</a> that never returns <code>NULL</code> on success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00536_source.html#l00036">36</a> of file <a class="el" href="a00536_source.html">htable_get.c</a>.</p>

<p class="reference">References <a class="el" href="a00350_source.html#l00035">pcl_err_clear()</a>, <a class="el" href="a00548_source.html#l00036">pcl_htable_lookup()</a>, <a class="el" href="a00017_source.html#l00287">R_TRC</a>, and <a class="el" href="a00059_source.html#l00248">pcl_htable_entry_t::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00725_source.html#l00036">pcl_json_objget()</a>.</p>

</div>
</div>
<a id="gaababde7190354fb3a74138272c1e90cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaababde7190354fb3a74138272c1e90cd">&#9670;&nbsp;</a></span>pcl_htable_put()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> int pcl_htable_put </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a> *&#160;</td>
          <td class="paramname"><em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>unique</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="a00059.html">pcl/htable.h</a>&gt;</code></p>

<p>&#x202A;Puts a key/value pair into the table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ht</td><td>&#x202A;pointer to hash table object </td></tr>
    <tr><td class="paramname">key</td><td>&#x202A;pointer to the key. This is shallow assignment. </td></tr>
    <tr><td class="paramname">value</td><td>&#x202A;pointer to the entry's value. This is shallow assignment. </td></tr>
    <tr><td class="paramname">unique</td><td>&#x202A;indicates if the put operation should enforce unique keys. When true, if a key exists the operation fails. When false, a matching entry's key and value are replaced with the given key and value; remove_entry called with old key and value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>&#x202A;0 on success and -1 on error. For unique puts, pcl_errno is set to PCL_EEXISTS. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00551_source.html#l00037">37</a> of file <a class="el" href="a00551_source.html">htable_put.c</a>.</p>

<p class="reference">References <a class="el" href="a00017_source.html#l00306">BADARG</a>, <a class="el" href="a00059_source.html#l00269">tag_pcl_htable::capacity</a>, <a class="el" href="a00059_source.html#l00242">pcl_htable_entry_t::code</a>, <a class="el" href="a00059_source.html#l00258">tag_pcl_htable::count</a>, <a class="el" href="a00059_source.html#l00264">tag_pcl_htable::count_used</a>, <a class="el" href="a00059_source.html#l00286">tag_pcl_htable::entries</a>, <a class="el" href="a00059_source.html#l00294">tag_pcl_htable::entry_lookup</a>, <a class="el" href="a00548_source.html#l00047">ipcl_htable_lookup()</a>, <a class="el" href="a00554_source.html#l00038">ipcl_htable_rehash()</a>, <a class="el" href="a00059_source.html#l00245">pcl_htable_entry_t::key</a>, <a class="el" href="a00059_source.html#l00324">tag_pcl_htable::max_loadfac</a>, <a class="el" href="a00059_source.html#l00239">pcl_htable_entry_t::next</a>, <a class="el" href="a00020_source.html#l00068">PCL_EEXIST</a>, <a class="el" href="a00362_source.html#l00035">pcl_err_freeze()</a>, <a class="el" href="a00059_source.html#l00333">tag_pcl_htable::remove_entry</a>, <a class="el" href="a00017_source.html#l00065">SETERR</a>, <a class="el" href="a00059_source.html#l00274">tag_pcl_htable::table_mask</a>, <a class="el" href="a00017_source.html#l00262">TRC</a>, and <a class="el" href="a00059_source.html#l00248">pcl_htable_entry_t::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00764_source.html#l00038">pcl_json_objput()</a>.</p>

</div>
</div>
<a id="gaf0360dbdb51aea5ba45f0b398d1319a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf0360dbdb51aea5ba45f0b398d1319a8">&#9670;&nbsp;</a></span>pcl_htable_remove()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> int pcl_htable_remove </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a> *&#160;</td>
          <td class="paramname"><em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="a00059.html">pcl/htable.h</a>&gt;</code></p>

<p>&#x202A;Remove an entry from the table. </p>
<p class="DocNodeLTR">If the key does not exist, this call is silently ignored. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ht</td><td>&#x202A;pointer to hash table object </td></tr>
    <tr><td class="paramname">key</td><td>&#x202A;pointer to the entry's key to remove </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>&#x202A;new count of entries or -1 on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00557_source.html#l00036">36</a> of file <a class="el" href="a00557_source.html">htable_remove.c</a>.</p>

<p class="reference">References <a class="el" href="a00017_source.html#l00306">BADARG</a>, <a class="el" href="a00059_source.html#l00269">tag_pcl_htable::capacity</a>, <a class="el" href="a00059_source.html#l00242">pcl_htable_entry_t::code</a>, <a class="el" href="a00059_source.html#l00258">tag_pcl_htable::count</a>, <a class="el" href="a00059_source.html#l00286">tag_pcl_htable::entries</a>, <a class="el" href="a00059_source.html#l00294">tag_pcl_htable::entry_lookup</a>, <a class="el" href="a00059_source.html#l00362">tag_pcl_htable::hashcode</a>, <a class="el" href="a00554_source.html#l00038">ipcl_htable_rehash()</a>, <a class="el" href="a00059_source.html#l00245">pcl_htable_entry_t::key</a>, <a class="el" href="a00059_source.html#l00342">tag_pcl_htable::key_equals</a>, <a class="el" href="a00059_source.html#l00306">tag_pcl_htable::key_len</a>, <a class="el" href="a00059_source.html#l00315">tag_pcl_htable::min_loadfac</a>, <a class="el" href="a00521_source.html#l00039">MINTBLSIZE</a>, <a class="el" href="a00059_source.html#l00239">pcl_htable_entry_t::next</a>, <a class="el" href="a00059_source.html#l00333">tag_pcl_htable::remove_entry</a>, <a class="el" href="a00059_source.html#l00274">tag_pcl_htable::table_mask</a>, <a class="el" href="a00017_source.html#l00262">TRC</a>, and <a class="el" href="a00059_source.html#l00248">pcl_htable_entry_t::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00782_source.html#l00036">pcl_json_objremove()</a>.</p>

</div>
</div>
<a id="ga4162cecb47c4e51ed421bb043a2c4827"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4162cecb47c4e51ed421bb043a2c4827">&#9670;&nbsp;</a></span>pcl_htable_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> <a class="el" href="a00113.html#a157296b59a693af5c94886de7d036223">pcl_array_t</a>* pcl_htable_keys </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a> *&#160;</td>
          <td class="paramname"><em>ht</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="a00059.html">pcl/htable.h</a>&gt;</code></p>

<p>&#x202A;Get hash table keys as an array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ht</td><td>&#x202A;pointer to hash table object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>&#x202A;array on success and <code>NULL</code> on error. An empty table produces an empty array. This array must be freed by caller. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00545_source.html#l00036">36</a> of file <a class="el" href="a00545_source.html">htable_keys.c</a>.</p>

<p class="reference">References <a class="el" href="a00059_source.html#l00258">tag_pcl_htable::count</a>, <a class="el" href="a00059_source.html#l00264">tag_pcl_htable::count_used</a>, <a class="el" href="a00059_source.html#l00286">tag_pcl_htable::entries</a>, <a class="el" href="a00059_source.html#l00245">pcl_htable_entry_t::key</a>, <a class="el" href="a00143_source.html#l00036">pcl_array()</a>, and <a class="el" href="a00026_source.html#l00177">pcl_array_append()</a>.</p>

</div>
</div>
<a id="ga0c0e446d70b2fa00e5c2823ed3b7de27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0c0e446d70b2fa00e5c2823ed3b7de27">&#9670;&nbsp;</a></span>pcl_htable_iter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> <a class="el" href="a01417.html">pcl_htable_entry_t</a>* pcl_htable_iter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a> *&#160;</td>
          <td class="paramname"><em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="a00059.html">pcl/htable.h</a>&gt;</code></p>

<p>&#x202A;Iterate through a table's entries. </p>
<p class="DocNodeLTR">This automatically skips deleted entries, which means the given <em>index</em> pointer can skip indexes during the iteration: like given 1 on input could produce 5 on output. </p><div class="fragment"><div class="line"><span class="comment">// typical usage</span></div>
<div class="line"><span class="keywordtype">int</span> index = 0;</div>
<div class="line"><a class="code" href="a01417.html">pcl_htable_entry_t</a> *ent;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// the iteration is always insertion order. the index can skip index values,</span></div>
<div class="line"><span class="comment">// which means it skipped one or more deleted entries.</span></div>
<div class="line"><span class="keywordflow">while</span>((ent = <a class="code" href="a01381.html#ga0c0e446d70b2fa00e5c2823ed3b7de27">pcl_htable_iter</a>(ht, &amp;index)))</div>
<div class="line">  printf(<span class="stringliteral">&quot;entries[%d] %s\n&quot;</span>, index - 1, ent-&gt;<a class="code" href="a01417.html#a9eb073a4e7f31790de2c4f6b2ea74081">key</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// can also use this to retrieve the N-th entry</span></div>
<div class="line"><span class="keywordtype">int</span> index = 9; <span class="comment">// logical 10-th entry inserted, physical depends on num deleted</span></div>
<div class="line"><a class="code" href="a01417.html">pcl_htable_entry_t</a> *ent = <a class="code" href="a01381.html#ga0c0e446d70b2fa00e5c2823ed3b7de27">pcl_htable_iter</a>(ht, &amp;index);</div>
</div><!-- fragment --> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ht</td><td>&#x202A;pointer to a hash table </td></tr>
    <tr><td class="paramname">index</td><td>&#x202A;pointer to an integer that on input, represents the N-th entry to retrieve. On output, this represents the next index value. This cannot be less than zero or greater than <em>count_used</em>. This is typically set to zero to iterate through all entries. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>&#x202A;pointer to the next entry or <code>NULL</code> when complete. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00542_source.html#l00035">35</a> of file <a class="el" href="a00542_source.html">htable_iter.c</a>.</p>

<p class="reference">References <a class="el" href="a00059_source.html#l00264">tag_pcl_htable::count_used</a>, <a class="el" href="a00059_source.html#l00286">tag_pcl_htable::entries</a>, and <a class="el" href="a00059_source.html#l00245">pcl_htable_entry_t::key</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00695_source.html#l00036">ipcl_json_encode_object()</a>.</p>

</div>
</div>
<a id="ga8b1170fdf3619ddac333d144c4b10a93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8b1170fdf3619ddac333d144c4b10a93">&#9670;&nbsp;</a></span>pcl_htable_clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> void pcl_htable_clear </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a> *&#160;</td>
          <td class="paramname"><em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>shrink</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="a00059.html">pcl/htable.h</a>&gt;</code></p>

<p>&#x202A;Clear all entries from the table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ht</td><td>&#x202A;pointer to hash table object </td></tr>
    <tr><td class="paramname">shrink</td><td>&#x202A;when true, the table will be shrunk down to the smallest table size; 17. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00530_source.html#l00037">37</a> of file <a class="el" href="a00530_source.html">htable_clear.c</a>.</p>

<p class="reference">References <a class="el" href="a00059_source.html#l00269">tag_pcl_htable::capacity</a>, <a class="el" href="a00059_source.html#l00258">tag_pcl_htable::count</a>, <a class="el" href="a00059_source.html#l00264">tag_pcl_htable::count_used</a>, <a class="el" href="a00059_source.html#l00286">tag_pcl_htable::entries</a>, <a class="el" href="a00059_source.html#l00294">tag_pcl_htable::entry_lookup</a>, <a class="el" href="a00539_source.html#l00037">ipcl_htable_init()</a>, <a class="el" href="a00059_source.html#l00245">pcl_htable_entry_t::key</a>, <a class="el" href="a00521_source.html#l00039">MINTBLSIZE</a>, <a class="el" href="a01370.html#gab88b901c82e1010555b08ff6d39490f2">pcl_free()</a>, <a class="el" href="a00059_source.html#l00333">tag_pcl_htable::remove_entry</a>, <a class="el" href="a00059_source.html#l00274">tag_pcl_htable::table_mask</a>, and <a class="el" href="a00059_source.html#l00248">pcl_htable_entry_t::value</a>.</p>

</div>
</div>
<a id="ga59f432a730f55758cc65114510213f95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga59f432a730f55758cc65114510213f95">&#9670;&nbsp;</a></span>pcl_htable_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00038.html#af51b10412004b8f639fc2541fe770377">PCL_PUBLIC</a> void* pcl_htable_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00113.html#a837674424510bcf55b9b1eaa8acf639f">pcl_htable_t</a> *&#160;</td>
          <td class="paramname"><em>ht</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="a00059.html">pcl/htable.h</a>&gt;</code></p>

<p>&#x202A;Release all resources used by the given hash table. </p>
<p class="DocNodeLTR">If a remove_entry callback is set on the given hash table, it will be called for each entry. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ht</td><td>&#x202A;pointer to hash table object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>&#x202A;always returns NULL, which is useful as an assignment and free in a single line: <code>my_obj-&gt;ht = pcl_htable_free(my_obj-&gt;ht)</code> </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00533_source.html#l00036">36</a> of file <a class="el" href="a00533_source.html">htable_free.c</a>.</p>

<p class="reference">References <a class="el" href="a00059_source.html#l00264">tag_pcl_htable::count_used</a>, <a class="el" href="a00059_source.html#l00286">tag_pcl_htable::entries</a>, <a class="el" href="a00059_source.html#l00245">pcl_htable_entry_t::key</a>, <a class="el" href="a01370.html#gab88b901c82e1010555b08ff6d39490f2">pcl_free()</a>, <a class="el" href="a00059_source.html#l00333">tag_pcl_htable::remove_entry</a>, and <a class="el" href="a00059_source.html#l00248">pcl_htable_entry_t::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00707_source.html#l00038">pcl_json_free()</a>.</p>

</div>
</div>
</div><!-- contents -->
<div class="ttc" id="aa01421_html_aaa2dc552577da2bba064c4d36d971c26"><div class="ttname"><a href="a01421.html#aaa2dc552577da2bba064c4d36d971c26">tag_pcl_htable::key_len</a></div><div class="ttdeci">size_t key_len</div><div class="ttdoc">Key length in bytes.</div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00306">htable.h:306</a></div></div>
<div class="ttc" id="aa01421_html_aa29bc4287f3bba04ee0471d6e8979c5a"><div class="ttname"><a href="a01421.html#aa29bc4287f3bba04ee0471d6e8979c5a">tag_pcl_htable::remove_entry</a></div><div class="ttdeci">void(* remove_entry)(const void *key, void *value)</div><div class="ttdoc">Called when an entry is being removed from the table.</div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00333">htable.h:333</a></div></div>
<div class="ttc" id="aa01421_html"><div class="ttname"><a href="a01421.html">tag_pcl_htable</a></div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00251">htable.h:252</a></div></div>
<div class="ttc" id="aa01381_html_ga00324aa197254805fd247819cf95164d"><div class="ttname"><a href="a01381.html#ga00324aa197254805fd247819cf95164d">pcl_htable_get</a></div><div class="ttdeci">PCL_PUBLIC void * pcl_htable_get(const pcl_htable_t *ht, const void *key)</div><div class="ttdoc">Lookup an entry and return its value.</div><div class="ttdef"><b>Definition:</b> <a href="a00536_source.html#l00036">htable_get.c:36</a></div></div>
<div class="ttc" id="aa01421_html_a1d24fd47b1023fb237ae37964028806a"><div class="ttname"><a href="a01421.html#a1d24fd47b1023fb237ae37964028806a">tag_pcl_htable::key_equals</a></div><div class="ttdeci">bool(* key_equals)(const void *key1, const void *key2, size_t key_len)</div><div class="ttdoc">Determine if two keys are equal.</div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00342">htable.h:342</a></div></div>
<div class="ttc" id="aa01370_html_gab88b901c82e1010555b08ff6d39490f2"><div class="ttname"><a href="a01370.html#gab88b901c82e1010555b08ff6d39490f2">pcl_free</a></div><div class="ttdeci">void * pcl_free(void *p)</div><div class="ttdoc">Free memory space.</div></div>
<div class="ttc" id="aa01381_html_ga59f432a730f55758cc65114510213f95"><div class="ttname"><a href="a01381.html#ga59f432a730f55758cc65114510213f95">pcl_htable_free</a></div><div class="ttdeci">PCL_PUBLIC void * pcl_htable_free(pcl_htable_t *ht)</div><div class="ttdoc">Release all resources used by the given hash table.</div><div class="ttdef"><b>Definition:</b> <a href="a00533_source.html#l00036">htable_free.c:36</a></div></div>
<div class="ttc" id="aa00059_html"><div class="ttname"><a href="a00059.html">htable.h</a></div></div>
<div class="ttc" id="aa01390_html_ga27a03710e9bf0a479cc6f0d83855bf68"><div class="ttname"><a href="a01390.html#ga27a03710e9bf0a479cc6f0d83855bf68">pcl_hex_decode</a></div><div class="ttdeci">PCL_PUBLIC int pcl_hex_decode(void *buf, size_t size, const char *hex)</div><div class="ttdoc">Decode a hexadecimal string.</div><div class="ttdef"><b>Definition:</b> <a href="a01118_source.html#l00054">hex_decode.c:54</a></div></div>
<div class="ttc" id="aa01417_html"><div class="ttname"><a href="a01417.html">pcl_htable_entry_t</a></div><div class="ttdoc">Hash table entry object.</div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00236">htable.h:237</a></div></div>
<div class="ttc" id="aa01421_html_a33adfa1338869be7f83985d3bf1e0a38"><div class="ttname"><a href="a01421.html#a33adfa1338869be7f83985d3bf1e0a38">tag_pcl_htable::hashcode</a></div><div class="ttdeci">uintptr_t(* hashcode)(const void *key, size_t key_len)</div><div class="ttdoc">Compute a hash code for the given key.</div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00362">htable.h:362</a></div></div>
<div class="ttc" id="aa00038_html_a9b58a1294d89c976dfbe4dc480e9dfb8"><div class="ttname"><a href="a00038.html#a9b58a1294d89c976dfbe4dc480e9dfb8">UNUSED</a></div><div class="ttdeci">#define UNUSED(...)</div><div class="ttdef"><b>Definition:</b> <a href="a00038_source.html#l00124">defs.h:124</a></div></div>
<div class="ttc" id="aa01417_html_a9eb073a4e7f31790de2c4f6b2ea74081"><div class="ttname"><a href="a01417.html#a9eb073a4e7f31790de2c4f6b2ea74081">pcl_htable_entry_t::key</a></div><div class="ttdeci">const void * key</div><div class="ttdoc">entry key</div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00245">htable.h:245</a></div></div>
<div class="ttc" id="aa01382_html_gac1f7c09d58b0d949a660b42924dd21d4"><div class="ttname"><a href="a01382.html#gac1f7c09d58b0d949a660b42924dd21d4">pcl_init</a></div><div class="ttdeci">PCL_PUBLIC void pcl_init(void)</div><div class="ttdoc">Initializes the PCL library.</div><div class="ttdef"><b>Definition:</b> <a href="a00566_source.html#l00062">init.c:62</a></div></div>
<div class="ttc" id="aa00062_html"><div class="ttname"><a href="a00062.html">init.h</a></div></div>
<div class="ttc" id="aa01381_html_gaababde7190354fb3a74138272c1e90cd"><div class="ttname"><a href="a01381.html#gaababde7190354fb3a74138272c1e90cd">pcl_htable_put</a></div><div class="ttdeci">PCL_PUBLIC int pcl_htable_put(pcl_htable_t *ht, const void *key, void *value, bool unique)</div><div class="ttdoc">Puts a key/value pair into the table.</div><div class="ttdef"><b>Definition:</b> <a href="a00551_source.html#l00037">htable_put.c:37</a></div></div>
<div class="ttc" id="aa01390_html_ga3b40ca44ca057a1a30a653533ab89481"><div class="ttname"><a href="a01390.html#ga3b40ca44ca057a1a30a653533ab89481">pcl_strreplace</a></div><div class="ttdeci">PCL_PUBLIC char * pcl_strreplace(const char *subject, const char *from, const char *to)</div><div class="ttdoc">Replace all occurances of a search string with a replacement string.</div></div>
<div class="ttc" id="aa01381_html_ga9c4338babd32ed1c05f5ad65b61662d2"><div class="ttname"><a href="a01381.html#ga9c4338babd32ed1c05f5ad65b61662d2">pcl_htable</a></div><div class="ttdeci">PCL_PUBLIC pcl_htable_t * pcl_htable(int capacity)</div><div class="ttdoc">Creates a new hash table object.</div><div class="ttdef"><b>Definition:</b> <a href="a00524_source.html#l00059">htable.c:59</a></div></div>
<div class="ttc" id="aa01370_html_ga1df8575b9ae906470c782db9c26201e8"><div class="ttname"><a href="a01370.html#ga1df8575b9ae906470c782db9c26201e8">pcl_malloc</a></div><div class="ttdeci">void * pcl_malloc(size_t n)</div><div class="ttdoc">Allocate dynamic memory.</div></div>
<div class="ttc" id="aa00098_html"><div class="ttname"><a href="a00098.html">string.h</a></div></div>
<div class="ttc" id="aa01381_html_ga0c0e446d70b2fa00e5c2823ed3b7de27"><div class="ttname"><a href="a01381.html#ga0c0e446d70b2fa00e5c2823ed3b7de27">pcl_htable_iter</a></div><div class="ttdeci">PCL_PUBLIC pcl_htable_entry_t * pcl_htable_iter(pcl_htable_t *ht, int *index)</div><div class="ttdoc">Iterate through a table's entries.</div><div class="ttdef"><b>Definition:</b> <a href="a00542_source.html#l00035">htable_iter.c:35</a></div></div>
<!-- HTML footer for doxygen 1.8.20-->
<!-- start footer part -->
</body>
</html>
